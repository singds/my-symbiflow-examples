See prerequisites section before doing all kind of stuff.  

This project is created for the [Arty 35T](https://www.xilinx.com/products/boards-and-kits/arty.html) board although could be adapted for other boards.  
  
Run `make` to build the fpga bitstream.  
When **Synthesis** and **Place & route** have soccessfully finished you can find the bitstream in **buil/** directory (top.bit).  
  
Connect the board with usb and run `make run` to load the bitstream in the FPGA and see your design running.

- **hw/** contains all verilog files that describes and test the riscv core.   
- **hw/test/** contains testbenches that tests single core components and the soc as a whole. **soc_test.v** tests the whole soc with a running software.
- **sw/** contains resources to compile software for the riscv core.


# prerequisites

You need to install:
- iverilog (Icarus Verilog). You need to compile it from sources because the version provided by your distribution is probably too old. Follow the instructions on the official github rpo README.  
Just report my installation commands for convenience:
```bash
sudo apt update
sudo apt install make gcc bison gperf autoconf flex

git clone https://github.com/steveicarus/iverilog.git
cd iverilog
sh autoconf.sh
./configure
make

make install
```
- To compile software for the core see **sw/README.md** with corresponding requisites.  



# useful resources

[RISC-V Assembly Programmer's Manual](https://github.com/riscv/riscv-asm-manual/blob/master/riscv-asm.md)  

[RV32i-opcodes](https://github.com/riscv/riscv-opcodes/blob/master/opcodes-rv32i)  

[Icarus Verilog Manual](https://iverilog.fandom.com/wiki/Main_Page)  

[linker script language](https://ftp.gnu.org/old-gnu/Manuals/ld-2.9.1/html_chapter/ld_3.html)



## useful commands

```bash
# set your toolchein prefix
TC=/opt/riscv32i/bin/riscv32-unknown-elf-

# compile assembly code  
${TC}as main.S -o build/out.elf

# disassembly code to see instruction hex values
${TC}objdump --disassemble -Mnumeric build/out.elf  

# get a section as hex file  
${TC}objcopy -j.text -O ihex build/out.elf build/out
/opt/riscv32i/bin/riscv32-unknown-elf-objcopy -j.text -O ihex build/out.elf build/out.hex  

# open waveforms generated by iverilog with gtkwave  
gtkwave build/soc_test.vcd &
```